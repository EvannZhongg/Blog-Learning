<!-- Giscus 评论系统 -->
<script src="https://giscus.app/client.js"
        data-repo="你的 GitHub 仓库路径"
        data-repo-id="你的 repo-id"
        data-category="Announcements"
        data-category-id="你的 category-id"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="light"
        data-lang="zh-CN"
        crossorigin="anonymous"
        async>
</script>

<!-- 主题自动同步（明暗模式） -->
<script>
  function setGiscusTheme(theme) {
    const iframe = document.querySelector('iframe.giscus-frame');
    if (!iframe) return;

    iframe.contentWindow.postMessage({
      giscus: {
        setConfig: {
          theme: theme === 'dark' ? 'dark' : 'light'
        }
      }
    }, 'https://giscus.app');
  }

  // 初始加载时设置主题
  window.addEventListener('DOMContentLoaded', () => {
    const storedTheme = localStorage.getItem('theme');
    const currentTheme = storedTheme === 'dark' ? 'dark' : 'light';
    setGiscusTheme(currentTheme);
  });

  // 切换按钮点击时同步 Giscus 主题
  document.addEventListener('DOMContentLoaded', () => {
    const themeButtons = [
      document.querySelector('.toggleBtn'),
      document.getElementById('mobile-toggle-theme')
    ];

    themeButtons.forEach(btn => {
      if (!btn) return;
      btn.addEventListener('click', () => {
        const newTheme = document.body.classList.contains('dark-theme') ? 'dark' : 'light';
        setGiscusTheme(newTheme);
      });
    });
  });
</script>
